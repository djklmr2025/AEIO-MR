(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(9828)}])},9828:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var r=t(5893),i=t(645),s=t.n(i),o=t(7294),n=t(9008),c=t.n(n),l=t(3454);function d(){let[e,a]=(0,o.useState)(""),[t,i]=(0,o.useState)([]),[n,d]=(0,o.useState)(""),[x,m]=(0,o.useState)([]),[p,f]=(0,o.useState)(!1),[b,g]=(0,o.useState)(!1),[u,h]=(0,o.useState)(!1),w=(0,o.useRef)(null),y=(0,o.useRef)(null),j=l.env.NEXT_PUBLIC_API_URL||"https://glbx-arkaios-api.onrender.com";(0,o.useEffect)(()=>{let e=localStorage.getItem(CONVO_KEY);e||(e=crypto.randomUUID&&crypto.randomUUID()||String(Date.now()),localStorage.setItem(CONVO_KEY,e)),a(e),k({text:"\xa1Hola! Soy Arkaios (Gemini). Puedes adjuntar im\xe1genes o PDFs para que los tenga en cuenta. Activa \xabModo ROOT\xbb si necesitas una acci\xf3n administrativa.",who:"ai"}),O()},[]),(0,o.useEffect)(()=>{w.current&&(w.current.scrollTop=w.current.scrollHeight)},[t]);let k=e=>{let{text:a,who:t="ai",attachments:r=[],isSystem:s=!1}=e,o={id:Date.now(),text:a,who:t,attachments:r,isSystem:s,timestamp:new Date};return i(e=>[...e,o]),o},v=e=>{f(e)},z=()=>{f(!1)},N=e=>{m(a=>a.filter((a,t)=>t!==e))},S=async()=>{if(!x.length)return[];if(!j.includes("127.0.0.1")&&!j.includes("localhost"))return console.log("\uD83D\uDCC1 Simulando upload de archivos (modo demo)..."),x.map(e=>({name:e.name,url:URL.createObjectURL(e),type:e.type,size:e.size}));let e=new FormData;x.forEach(a=>e.append("files",a));try{let a=await fetch("".concat(j,"/upload"),{method:"POST",body:e});if(!a.ok){let e=await a.text();throw Error("Error al subir archivos: ".concat(a.status," ").concat(a.statusText," - ").concat(e))}return(await a.json()).files||[]}catch(e){throw console.error("Error uploading files:",e),e}},E=async()=>{let a=n.trim();if((a||0!==x.length)&&!u){d(""),h(!0);try{let t=await S();if(!j.includes("127.0.0.1")&&!j.includes("localhost")){await new Promise(e=>setTimeout(e,1e3)),v(!0),k({text:"✅ \xa1Frontend funcionando! Pero necesita conectar con el backend Flask.\n\nPara desarrollo local: ejecuta 'python server_gemini.py' y recarga.",who:"ai",attachments:t});return}let r=await fetch("".concat(j,"/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:a,attachments:t,root:b,conversationId:e})});if(!r.ok){let e;try{e=(await r.json()).respuesta||"Error ".concat(r.status,": ").concat(r.statusText)}catch(a){e="Error ".concat(r.status,": ").concat(r.statusText)}throw Error(e)}let i=await r.json();v(!0),k({text:i.respuesta||"(sin respuesta)",who:"ai",attachments:t})}catch(e){console.error("Error sending message:",e),v(!1),k({text:"❌ Error: "+e.message,who:"ai",isSystem:!0})}finally{h(!1),m([])}}},C=async()=>{if(confirm("\xbfEst\xe1s seguro de que quieres borrar todo el historial y la memoria?")){try{await fetch("".concat(j,"/clear"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({conversationId:e})})}catch(e){console.warn("Error clearing memory:",e)}i([]),k({text:"Memoria e historial de esta conversaci\xf3n borrados.",who:"ai",isSystem:!0}),k({text:"\xa1Hola! Soy Arkaios (Gemini). Puedes adjuntar im\xe1genes o PDFs para que los tenga en cuenta. Activa \xabModo ROOT\xbb si necesitas una acci\xf3n administrativa.",who:"ai"})}},D=async()=>{if(z(),!j.includes("127.0.0.1")&&!j.includes("localhost")){setTimeout(()=>{v(!1),k({text:"\uD83C\uDF10 Modo Demo: Frontend funciona pero backend no conectado\n\nEjecuta localmente:\n1. python server_gemini.py\n2. Recarga esta p\xe1gina",who:"ai",isSystem:!0})},1e3);return}try{let e=await fetch("".concat(j,"/health"),{method:"GET",cache:"no-cache"});if(e.ok){let a=await e.json();v(!0);let t="✅ Servidor OK\n- Estado: ".concat(a.status,"\n- Modelo: ").concat(a.model);k({text:t,who:"ai",isSystem:!0})}else v(!1),k({text:"❌ Servidor respondi\xf3 con error: "+e.status,who:"ai",isSystem:!0})}catch(e){v(!1),k({text:"❌ No se pudo conectar al servidor: "+e.message,who:"ai",isSystem:!0})}},O=async()=>{try{let e=await fetch("".concat(j,"/health"),{method:"GET",cache:"no-cache"});v(e.ok)}catch(e){console.warn("Conexi\xf3n inicial fall\xf3:",e),v(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c(),{children:[(0,r.jsx)("title",{className:"jsx-da92fe29224c9065",children:"Arkaios UI — Gemini"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1",className:"jsx-da92fe29224c9065"}),(0,r.jsx)("link",{rel:"icon",href:"https://img.icons8.com/fluency/48/robot-2.png",className:"jsx-da92fe29224c9065"})]}),(0,r.jsxs)("div",{className:"jsx-da92fe29224c9065 wrap",children:[(0,r.jsxs)("header",{className:"jsx-da92fe29224c9065",children:[(0,r.jsx)("h1",{className:"jsx-da92fe29224c9065",children:"ARKAIOS UI"}),(0,r.jsx)("span",{className:"jsx-da92fe29224c9065 badge",children:"Proveedor: Gemini"}),(0,r.jsx)("span",{className:"jsx-da92fe29224c9065 "+"status ".concat(p?"online":"offline"),children:p?"Conectado":"Desconectado"}),(0,r.jsxs)("span",{title:"Permite \xf3rdenes administrativas",className:"jsx-da92fe29224c9065 right switch",children:[(0,r.jsx)("input",{type:"checkbox",id:"rootToggle",checked:b,onChange:e=>g(e.target.checked),className:"jsx-da92fe29224c9065"}),(0,r.jsx)("label",{htmlFor:"rootToggle",className:"jsx-da92fe29224c9065",children:"Modo ROOT"})]})]}),(0,r.jsx)("main",{id:"history",ref:w,className:"jsx-da92fe29224c9065",children:t.map(e=>{var a;return(0,r.jsxs)("div",{className:"jsx-da92fe29224c9065 "+"msg ".concat(e.who," ").concat(e.isSystem?"system":""," ").concat("ai"===e.who&&b?"root":""),children:[(0,r.jsx)("div",{className:"jsx-da92fe29224c9065 head",children:e.isSystem?"Sistema":"user"===e.who?"T\xfa":b?"Arkaios (ROOT/Gemini)":"Arkaios (Gemini)"}),(0,r.jsx)("div",{className:"jsx-da92fe29224c9065 content",children:e.text}),(null===(a=e.attachments)||void 0===a?void 0:a.length)>0&&(0,r.jsx)("div",{className:"jsx-da92fe29224c9065 attachments",children:e.attachments.map((e,a)=>{var t;return(0,r.jsx)("div",{className:"jsx-da92fe29224c9065 thumb",children:(null===(t=e.type)||void 0===t?void 0:t.startsWith("image/"))?(0,r.jsx)("img",{src:e.preview||e.url,alt:e.name,onError:e=>{e.target.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><text y="50%" x="50%" text-anchor="middle" dy=".3em">❌</text></svg>'},className:"jsx-da92fe29224c9065"}):(0,r.jsxs)("span",{className:"jsx-da92fe29224c9065",children:["\uD83D\uDCC4 ",e.name||e.url]})},a)})})]},e.id)})}),(0,r.jsxs)("section",{className:"jsx-da92fe29224c9065 panel",children:[(0,r.jsxs)("div",{className:"jsx-da92fe29224c9065 filebar",children:[(0,r.jsx)("input",{type:"file",ref:y,multiple:!0,accept:"image/*,application/pdf,.pdf,.txt,.md,.json",onChange:e=>{let a=Array.from(e.target.files).filter(e=>e.size<=10485760);a.length!==e.target.files.length&&k({text:"Algunos archivos fueron omitidos por ser muy grandes (m\xe1x 10MB)",who:"ai",isSystem:!0}),m(e=>[...e,...a]),e.target.value=""},className:"jsx-da92fe29224c9065"}),(0,r.jsx)("button",{onClick:()=>{m([]),y.current&&(y.current.value="")},title:"Quitar adjuntos",disabled:0===x.length,className:"jsx-da92fe29224c9065 btn",children:"Limpiar adjuntos"})]}),x.length>0&&(0,r.jsx)("div",{className:"jsx-da92fe29224c9065 previews",children:x.map((e,a)=>(0,r.jsxs)("div",{style:{position:"relative"},className:"jsx-da92fe29224c9065 thumb",children:[e.type.startsWith("image/")?(0,r.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,style:{maxWidth:"100px",maxHeight:"100px"},className:"jsx-da92fe29224c9065"}):(0,r.jsxs)("span",{className:"jsx-da92fe29224c9065",children:["\uD83D\uDCC4 ",e.name]}),(0,r.jsx)("button",{style:{position:"absolute",top:"-8px",right:"-8px",width:"20px",height:"20px",borderRadius:"50%",background:"var(--danger)",color:"white",border:"none",cursor:"pointer",fontSize:"12px",lineHeight:"1"},onClick:()=>N(a),className:"jsx-da92fe29224c9065",children:"\xd7"})]},a))}),(0,r.jsx)("textarea",{value:n,onChange:e=>d(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),E())},placeholder:"Escribe tu mensaje…",maxLength:4e3,disabled:u,className:"jsx-da92fe29224c9065"}),(0,r.jsxs)("div",{className:"jsx-da92fe29224c9065 row",children:[(0,r.jsxs)("div",{className:"jsx-da92fe29224c9065",children:[(0,r.jsx)("button",{onClick:C,title:"Borra historial y memoria",className:"jsx-da92fe29224c9065 btn",children:"Limpiar chat"}),(0,r.jsx)("button",{onClick:D,title:"Probar conexi\xf3n con el backend",className:"jsx-da92fe29224c9065 btn warning",children:"Ping"}),(0,r.jsxs)("span",{className:"jsx-da92fe29224c9065 hint",children:["CID: ",e?"".concat(e.slice(0,8),"…"):"generando..."]})]}),(0,r.jsx)("button",{onClick:E,disabled:u||!n.trim()&&0===x.length,className:"jsx-da92fe29224c9065 "+"btn primary ".concat(u?"loading":""),children:u?"Enviando...":"Enviar"})]})]})]}),(0,r.jsx)(s(),{id:"da92fe29224c9065",children:".jsx-da92fe29224c9065:root{--bg:#091017;--surface:#0d1a28;--ink:#e6f1ff;--muted:#9fb4d3;--brand:#00e1a3;--accent:#4ea2ff;--danger:#ff5b8a;--line:#14314f}*.jsx-da92fe29224c9065{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}html.jsx-da92fe29224c9065,body.jsx-da92fe29224c9065{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--ink)}.wrap.jsx-da92fe29224c9065{max-width:1100px;margin:0 auto;padding:16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100vh}header.jsx-da92fe29224c9065{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:12px;margin-bottom:12px;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}header.jsx-da92fe29224c9065 h1.jsx-da92fe29224c9065{font-size:20px;margin:0}.badge.jsx-da92fe29224c9065{font-size:12px;padding:4px 8px;-webkit-border-radius:999px;-moz-border-radius:999px;border-radius:999px;background:#0e253e;border:1px solid var(--line);color:#bfe2ff}.status.jsx-da92fe29224c9065{font-size:11px;padding:2px 6px;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;margin-left:8px}.status.online.jsx-da92fe29224c9065{background:#004225;color:#00e1a3;border:1px solid#006b3d}.status.offline.jsx-da92fe29224c9065{background:#3d1a1a;color:#ff5b8a;border:1px solid#5c2929}.status.connecting.jsx-da92fe29224c9065{background:#3d3d1a;color:#e1e100;border:1px solid#5c5c29}#history.jsx-da92fe29224c9065{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;overflow:auto;border:1px solid var(--line);-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:14px;background:rgba(255,255,255,.03);margin-bottom:12px}.msg.jsx-da92fe29224c9065{padding:12px;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;margin-bottom:12px;opacity:0;-webkit-animation:fadeIn.3s forwards;-moz-animation:fadeIn.3s forwards;-o-animation:fadeIn.3s forwards;animation:fadeIn.3s forwards}.msg.user.jsx-da92fe29224c9065{background:rgba(0,225,163,.14);border:1px solid rgba(0,225,163,.35);margin-left:15%}.msg.ai.jsx-da92fe29224c9065{background:rgba(78,162,255,.12);border:1px solid rgba(78,162,255,.35);margin-right:15%}.msg.root.jsx-da92fe29224c9065{background:rgba(255,91,138,.12);border:1px solid rgba(255,91,138,.35)}.msg.system.jsx-da92fe29224c9065{background:rgba(255,193,7,.1);border:1px solid rgba(255,193,7,.3);text-align:center}.head.jsx-da92fe29224c9065{font-size:12px;color:var(--muted);margin-bottom:6px}.content.jsx-da92fe29224c9065{white-space:pre-wrap;line-height:1.6}.attachments.jsx-da92fe29224c9065{margin-top:8px;border-top:1px dashed var(--line);padding-top:8px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:8px}.thumb.jsx-da92fe29224c9065{display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:8px;border:1px solid var(--line);padding:6px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;background:var(--surface)}.thumb.jsx-da92fe29224c9065 img.jsx-da92fe29224c9065{max-width:160px;max-height:110px;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;display:block}.panel.jsx-da92fe29224c9065{border:1px solid var(--line);background:var(--surface);-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:12px}textarea.jsx-da92fe29224c9065{width:100%;min-height:90px;resize:none;background:rgba(255,255,255,.04);border:1px solid var(--line);-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;padding:12px;color:var(--ink);font-family:inherit}textarea.jsx-da92fe29224c9065:focus{outline:none;border-color:var(--brand)}.row.jsx-da92fe29224c9065{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:8px;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-top:8px;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.btn.jsx-da92fe29224c9065{cursor:pointer;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;padding:10px 14px;border:1px solid var(--line);background:transparent;color:var(--ink);font-size:13px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;font-family:inherit}.btn.jsx-da92fe29224c9065:hover{border-color:var(--brand);background:rgba(0,225,163,.1)}.btn.jsx-da92fe29224c9065:disabled{opacity:.5;cursor:not-allowed}.btn.primary.jsx-da92fe29224c9065{background:var(--brand);color:#001b12;border:none;font-weight:600}.btn.primary.jsx-da92fe29224c9065:hover{background:#00c491}.btn.primary.jsx-da92fe29224c9065:disabled{background:#006b51;color:#4a9d7a}.btn.warning.jsx-da92fe29224c9065{border-color:#ff9db8;color:#ffd0dd}.btn.warning.jsx-da92fe29224c9065:hover{background:rgba(255,91,138,.1)}.filebar.jsx-da92fe29224c9065{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:10px;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-top:8px;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.previews.jsx-da92fe29224c9065{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:10px;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px}.right.jsx-da92fe29224c9065{margin-left:auto}.switch.jsx-da92fe29224c9065{display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:8px;background:#15283f;border:1px solid var(--line);padding:6px 10px;borderradius:999px}.switch.jsx-da92fe29224c9065 input.jsx-da92fe29224c9065{accent-color:var(--danger)}.hint.jsx-da92fe29224c9065{font-size:12px;color:var(--muted)}.loading.jsx-da92fe29224c9065{opacity:.6}@-webkit-keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fadeIn{from{opacity:0;-moz-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fadeIn{from{opacity:0;-o-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(10px);-moz-transform:translatey(10px);-o-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}@media(max-width:768px){.wrap.jsx-da92fe29224c9065{padding:8px}.msg.user.jsx-da92fe29224c9065{margin-left:5%}.msg.ai.jsx-da92fe29224c9065{margin-right:5%}.filebar.jsx-da92fe29224c9065{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:stretch;-webkit-align-items:stretch;-moz-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}.row.jsx-da92fe29224c9065{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:stretch;-webkit-align-items:stretch;-moz-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}.right.jsx-da92fe29224c9065{margin-left:0}}"})]})}}},function(e){e.O(0,[742,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);