diff --git a/magic.html b/magic.html
index 91343e9..026ea95 100644
--- a/magic.html
+++ b/magic.html
@@ -50,6 +50,13 @@
   </style>
 </head>
 <body>
+  <div id="feature-toggles" class="toggle-row">
+    <label><input type="checkbox" id="toggle-image" checked> Imagen (HF)</label>
+    <label><input type="checkbox" id="toggle-3d"> 3D (Hunyuan)</label>
+    <label><input type="checkbox" id="toggle-web"> Búsqueda Web</label>
+    <label><input type="checkbox" id="toggle-memory" checked> Memoria</label>
+  </div>
+
   <div class="wrap">
     <header>
       <h1>ARKAIOS UI</h1>
@@ -196,7 +203,9 @@
     // ====== ARCHIVOS DESDE INPUT ======
     fileInput.addEventListener('change', e=>{
       const add = Array.from(e.target.files).filter(f=>f.size<=10*1024*1024);
-      if(add.length!==e.target.files.length) addMessage({text:'Algunos archivos >10MB se omitieron', who:'ai', isSystem:true});
+      if(add.length!==e.target.files.length) const genImgs=(data.generatedImages||[]).map(url=>({name:url.split('/').pop(),url,type:'image/png'}));
+    const allAtt=[...(uploaded||[]),...genImgs];
+    addMessage({ text:data.respuesta||'(sin respuesta)', who:'ai', attachments: allAtt });
       pendingFiles=[...pendingFiles,...add]; renderPreviews(); e.target.value='';
     });
     clearBtn.addEventListener('click',()=>{ pendingFiles=[]; renderPreviews(); fileInput.value=''; });
@@ -278,7 +287,7 @@
       if(!confirm('¿Borrar historial y memoria de esta conversación?')) return;
       try{
         const headers = {'Content-Type':'application/json'}; if (AUTH) headers['Authorization']='Bearer '+AUTH;
-        await fetch(`${API_BASE}/clear`, {method:'POST', headers, body:JSON.stringify({conversationId})});
+        await fetch(`${API_BASE}/clear`, {method:'POST', headers, body: JSON.stringify({conversationId, features: readFeatureFlags() })});
       }catch{}
       historyDiv.innerHTML=''; addMessage({text:'Memoria e historial borrados.', who:'ai', isSystem:true});
     });
@@ -300,6 +309,12 @@
       addMessage({text:'¡Hola! Soy Arkaios (ROOT/Gemini). Puedes pegar capturas con Ctrl+V y usar: "buscar en google: …".', who:'ai'});
     }
     window.addEventListener('load', init);
-  </script>
+  
+  function readFeatureFlags(){return{image:document.getElementById('toggle-image')?.checked??true,threeD:document.getElementById('toggle-3d')?.checked??false,web:document.getElementById('toggle-web')?.checked??false,memory:document.getElementById('toggle-memory')?.checked??true};}
+  function loadFeatureFlags(){try{const f=JSON.parse(localStorage.getItem('arkaios:flags')||'{}');if('image'in f)document.getElementById('toggle-image').checked=!!f.image;if('threeD'in f)document.getElementById('toggle-3d').checked=!!f.threeD;if('web'in f)document.getElementById('toggle-web').checked=!!f.web;if('memory'in f)document.getElementById('toggle-memory').checked=!!f.memory;}catch{}}
+  function saveFeatureFlags(){localStorage.setItem('arkaios:flags',JSON.stringify(readFeatureFlags()));}
+  document.addEventListener('DOMContentLoaded',loadFeatureFlags);
+  ['toggle-image','toggle-3d','toggle-web','toggle-memory'].forEach(id=>{document.addEventListener('change',e=>{if(e.target&&e.target.id===id)saveFeatureFlags();});});
+</script>
 </body>
 </html>
diff --git a/server_gemini_merged_root.py b/server_gemini_merged_root.py
index 20e6581..26a5b66 100644
--- a/server_gemini_merged_root.py
+++ b/server_gemini_merged_root.py
@@ -174,7 +174,9 @@ def preflight_or_auth():
     if SERVER_AUTH_TOKEN:
         auth = request.headers.get("Authorization", "")
         if not auth.startswith("Bearer ") or auth.split(" ",1)[1].strip() != SERVER_AUTH_TOKEN:
-            return jsonify({"respuesta":"⛔ No autorizado"}), 401
+            for bad in ['cariño','mi amor','bebé']:
+            respuesta = re.sub(rf"\b{bad}\b","", respuesta, flags=re.IGNORECASE)
+        return jsonify({"respuesta":"⛔ No autorizado"}), 401
 
 # ================== INDEX / DIAGNÓSTICO ==================
 @app.route('/')
